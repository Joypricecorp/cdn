/*!
 * CTemplate
 * Version 1.1
 * Copyright(c) 2011-2013 Skirtle's Den
 * License: http://skirtlesden.com/ux/ctemplate
 */Ext.define("Skirtle.CTemplate",{alternateClassName:"Ext.ux.skirtle.CTemplate",extend:"Ext.XTemplate",statics:{AUTO_ID:0},copyDepth:10,cTpl:'<p id="ctemplate-{0}-{1}"></p>',isCTemplate:!0,constructor:function(){var e=this;e.callParent(arguments);e.id=++e.statics().AUTO_ID;e.reset()},copyValues:function(e,t){var n=this,r,i={},s=t||n.copyDepth;if(s===1)return e;if(Ext.isArray(e))return Ext.Array.map(e,function(e){return n.copyValues(e,s-1)});if(!Ext.isObject(e))return e;if(e.isComponent){r=e.getId();n.ids.push(r);return Ext.String.format(n.cTpl,r,n.id)}Ext.Object.each(e,function(e,t){i[e]=e==="$comp"?t:n.copyValues(t,s-1)});return i},doInsert:function(){var e=this.callParent(arguments);this.injectComponents();return e},doPolling:function(e){var t=this;t.pollInterval=e;t.pollId&&clearTimeout(t.pollId);t.pollId=Ext.defer(t.injectComponents,e,t)},getPlaceholderEl:function(e){return Ext.get("ctemplate-"+e+"-"+this.id)},injectComponents:function(){var e=this,t=e.ids,n=t.length-1,r,i,s;for(;n>=0;--n){r=t[n];i=Ext.getCmp(r);s=e.getPlaceholderEl(r);if(e.renderComponent(i,s)||!i){Ext.Array.splice(t,n,1);s&&s.remove()}}t.length&&e.doPolling(e.pollInterval*1.5)},overwrite:function(e){var t,n,r;if(Ext.isIE){t=Ext.getDom(e);while(n=t.firstChild)t.removeChild(n)}r=this.callParent(arguments);this.injectComponents();return r},renderComponent:function(e,t){if(e&&t){var n=t.parent();e.rendered?e.getEl().replace(t):e.render(n,t);Ext.isIE6&&n.repaint();return!0}return!1},reset:function(){var e=this;e.ids=[];if(e.pollId){clearTimeout(e.pollId);e.pollId=null}}},function(e){var t=function(){var e=this,t=Ext.Array.slice(arguments);t[0]=e.copyValues(t[0]);e.doPolling(10);return e.callParent(t)};if(e.prototype.applyOut)e.override({applyOut:t});else{e.override({applyTemplate:t});e.createAlias("apply","applyTemplate")}});