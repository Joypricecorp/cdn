/*!
 * Ext JS Library 4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 *//**
 * Barebones iframe implementation. For serious iframe work, see the ManagedIFrame extension
 * (http://www.sencha.com/forum/showthread.php?71961).
 *
 * @class Ext.ux.IFrame
 *
 * @@ this mo by BOON @@
 *
 */Ext.define("Ext.ux.IFrame",{extend:"Ext.Component",alias:"widget.uxiframe",loadMask:"Loading...",src:"about:blank",emptyData:"",style:"position: relative;height: 100%;",renderTpl:['<iframe src="{src}" name="{frameName}" width="100%" height="100%" frameborder="0"></iframe>','<div class="x-empty-iframe" id="empty-{frameName}" style="width:100%;height:100%">{emptyData}</div>'],initComponent:function(){this.callParent();this.frameName=this.frameName||this.id+"-frame";this.addEvents("beforeload","load");Ext.apply(this.renderSelectors,{iframeEl:"iframe",emptyEl:"div.x-empty-iframe"});this.callParent();this.on("afterrender",this.display,this)},initEvents:function(){var e=this,t=e.iframeEl.dom,n=e.getFrame();e.callParent();e.iframeEl.on("load",e.onLoad,e)},initRenderData:function(){return Ext.apply(this.callParent(),{src:this.src,frameName:this.frameName,emptyData:this.emptyData})},emptySrc:function(){return!this.src||this.src==""||this.src=="about:blank"},display:function(){if(this.emptySrc())this.empty();else{this.emptyEl.addCls("x-hidden");this.iframeEl.removeCls("x-hidden")}},empty:function(e){e&&this.emptyEl.update(e);this.emptyEl.removeCls("x-hidden");this.iframeEl.addCls("x-hidden")},getBody:function(){var e=this.getDoc();return e.body||e.documentElement},getDoc:function(){try{return this.getWin().document}catch(e){return null}},getWin:function(){var e=this,t=e.frameName,n=Ext.isIE?e.iframeEl.dom.contentWindow:window.frames[t];return n},getFrame:function(){var e=this;return e.iframeEl.dom},beforeDestroy:function(){var e=this,t,n;if(e.rendered)try{t=e.getDoc();if(t){Ext.EventManager.removeAll(t);for(n in t)t.hasOwnProperty&&t.hasOwnProperty(n)&&delete t[n]}}catch(r){}e.callParent()},onLoad:function(){var e=this,t=e.getDoc(),n=e.onRelayedEvent;if(t){try{Ext.EventManager.removeAll(t);Ext.EventManager.on(t,{mousedown:n,mousemove:n,mouseup:n,click:n,dblclick:n,scope:e})}catch(r){}Ext.EventManager.on(window,"unload",e.beforeDestroy,e);this.el.unmask();this.fireEvent("load",this)}else if(e.src&&e.src!=""){this.el.unmask();this.fireEvent("error",this)}},onRelayedEvent:function(e){var t=this.iframeEl,n=t.getXY(),r=e.getXY();e.xy=[n[0]+r[0],n[1]+r[1]];e.injectEvent(t);e.xy=r},load:function(e){var t=this,n=t.loadMask,r=t.getFrame();if(t.fireEvent("beforeload",t,e)!==!1){n&&t.el&&t.el.mask(n);r.src=t.src=e||t.src;t.display()}}});