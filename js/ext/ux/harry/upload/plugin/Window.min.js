/**
 * @class Ext.ux.upload.plugin.Window
 * @extends Ext.AbstractPlugin
 * 
 * @author Harald Hanek (c) 2011-2012
 * @license http://harrydeluxe.mit-license.org
 */Ext.define("Ext.ux.upload.plugin.Window",{extend:"Ext.AbstractPlugin",alias:"plugin.ux.upload.window",requires:["Ext.ux.statusbar.StatusBar","Ext.ux.statusbar.ValidationStatus"],constructor:function(e){var t=this;Ext.apply(t,e);t.callParent(arguments)},init:function(e){var t=this,n=e.uploader;e.on({filesadded:{fn:function(e,n){t.window.show()},scope:t},updateprogress:{fn:function(e,n,r,i,s,o,u,a){var f=Ext.String.format("Upload {0}% ({1} von {2})",r,i,n);t.statusbar.showBusy({text:f,clear:!1})},scope:t},uploadprogress:{fn:function(e,t,n,r,i){},scope:t},uploadcomplete:{fn:function(e,n,r){r.length==0&&t.window.hide()},scope:t}});t.statusbar=new Ext.ux.StatusBar({dock:"bottom",id:"form-statusbar",defaultText:"Ready"});t.view=new Ext.grid.Panel({store:n.store,stateful:!0,multiSelect:!0,hideHeaders:!0,stateId:"stateGrid",columns:[{text:"Name",flex:1,sortable:!1,dataIndex:"name"},{text:"Size",width:90,sortable:!0,align:"right",renderer:Ext.util.Format.fileSize,dataIndex:"size"},{text:"Change",width:75,sortable:!0,hidden:!0,dataIndex:"percent"},{text:"status",width:75,hidden:!0,sortable:!0,dataIndex:"status"},{text:"msg",width:175,sortable:!0,dataIndex:"msg"}],viewConfig:{stripeRows:!0,enableTextSelection:!1},dockedItems:[{dock:"top",enableOverflow:!0,xtype:"toolbar",style:{background:"transparent",border:"none",padding:"5px 0"},listeners:{beforerender:function(e){n.autoStart==0&&e.add(n.actions.start);e.add(n.actions.cancel);e.add(n.actions.removeAll);n.autoRemoveUploaded==0&&e.add(n.actions.removeUploaded)},scope:t}},t.statusbar]});t.window=new Ext.Window({title:t.title||"Upload files",width:t.width||640,height:t.height||380,plain:!0,constrain:!0,border:!1,layout:"fit",items:t.view,closeAction:"hide",listeners:{hide:function(e){},scope:this}})}});